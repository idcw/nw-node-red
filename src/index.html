<html>
<header>
    <script>
        const pkg = require('./package.json');
        let options;
        if (pkg.hasOwnProperty("NRnwjs")) {
            options = pkg["NRnwjs"]
        }

        // const urldash = "/ui/#/0"; // url for the dashboard page
        const urledit = "/red"; // url for the editor page
        // const urlconsole = "/console.htm"; // url for the console page
        const listenPort = options.port || 18880;

        let menu = new nw.Menu({
            type: 'menubar'
        });
        if (process.platform === 'darwin') {
            const appName = pkg["name"];
            menu.createMacBuiltin(appName, {
                hideEdit: true,
                hideWindow: false
            });
        }

        // const template = [{
        //     label: "View",
        //     submenu: [{
        //             label: 'Import Flow',
        //             key: "O",
        //             modifiers: "shift+alt",
        //             click: function () {
        //                 //  openFlow(); 
        //             }
        //         },
        //         {
        //             label: 'Save Flow As',
        //             key: "S",
        //             modifiers: "shift+alt"
        //             // click: function() { saveFlow(); }
        //         },
        //         {
        //             type: 'separator'
        //         },
        //         {
        //             label: 'Console',
        //             key: "C",
        //             modifiers: "shift+alt"
        //             // click: function() { createConsole(); }
        //         },
        //         {
        //             label: 'Dashboard',
        //             key: "D",
        //             modifiers: "shift+alt",
        //             click: function () {
        //                 nw.Window.open("http://localhost:" + listenPort + urldash);
        //             }
        //         },
        //         {
        //             label: 'Editor',
        //             key: "E",
        //             modifiers: "shift+alt",
        //             click: function () {
        //                 nw.Window.open("http://localhost:" + listenPort + urledit);
        //             }
        //         },
        //         {
        //             type: 'separator'
        //         },
        //         {
        //             type: 'separator'
        //         },
        //         {
        //             label: 'Documentation',
        //             click: function () {
        //                 nw.Shell.openExternal('https://nodered.org/docs')
        //             }
        //         },
        //         {
        //             label: 'Flows and Nodes',
        //             click: function () {
        //                 nw.Shell.openExternal('https://flows.nodered.org')
        //             }
        //         },
        //         {
        //             label: 'Discourse Forum',
        //             click: function () {
        //                 nw.Shell.openExternal('https://discourse.nodered.org/')
        //             }
        //         }
        //     ]
        // }];

        // var submenu = new nw.Menu();
        // for (const sm of template[0].submenu) {
        //     console.log(sm);
        //     submenu.append(new nw.MenuItem(sm));
        // }

        // menu.append(new nw.MenuItem({
        //     label: template[0].label,
        //     submenu: submenu
        // }));
        var win = nw.Window.get();
        win.menu = menu;
        win.setPosition("center");
        win.maximize();

        location.href = "http://localhost:" + listenPort + urledit;
    </script>
</header>
</html>